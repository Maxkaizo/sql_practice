# ğŸ“ Technical Notes and Design Decisions

This document contains key implementation details, lessons learned, and configuration decisions taken while building the SQL practice environment.

---

## ğŸ“Œ Decision: Using **Bind Mounts** instead of Named Volumes

To maintain full visibility and control over the files generated by PostgreSQL and PgAdmin, we chose to use **bind mounts** instead of Docker-managed named volumes.

This allows for:

- Easier manual inspection of internal database files.
- Flexible backup and version control.
- Greater transparency during learning and troubleshooting.

```yaml
volumes:
  - "./data/persistent/postgres_data:/var/lib/postgresql/data:rw"
  - "./data/persistent/pgadmin_data:/var/lib/pgadmin:rw"
````

---

## ğŸ” PgAdmin Permissions Issue

The official `dpage/pgadmin4` image runs as a non-root user with **UID 5050**.

When mounting a host directory to `/var/lib/pgadmin`, the container may fail to start with a permission error like:

```
ERROR: Failed to create the directory /var/lib/pgadmin/sessions: Permission denied
```

### âœ… Solution

Manually set ownership of the mounted directory to UID `5050`:

```bash
sudo chown -R 5050:5050 ./data/persistent/pgadmin_data
```

This grants PgAdmin permission to create necessary internal folders such as `sessions/`, `storage/`, and the SQLite config file `pgadmin4.db`.

---

## ğŸ§ª PgAdmin Internal Structure (Observed)

Once the container is running properly, the `pgadmin_data` folder will contain:

* `pgadmin4.db` â€“ Internal database with saved connections and settings.
* `sessions/` â€“ Temporary login session data.
* `storage/` â€“ File manager storage area for uploads/downloads.
* `azurecredentialcache/` â€“ Related to optional integration.

You should **avoid modifying these files manually** unless explicitly required.

---

## âœ… Good Practices Implemented

* Bind mounts are used **with `:rw` mode and quoted paths** to avoid YAML parsing issues.
* Environment variables are defined in a `.env` file for flexible configuration.
* SQL scripts are logically organized in `sql/` by purpose (`ddl`, `dml`, `queries`, `tests`).
* Folder structure reflects a full mini-pipeline: from raw data to processing and querying.

---

## ğŸ›  Future Improvements

* Add a `reset_db.sh` script to safely remove and recreate the database volumes.
* Include example datasets and query challenges in the `sql/queries/` folder.
* Expand `src/` with Python utilities for automated data ingestion and transformation.

---

**Maintained by:** \[Mazkaizo]
**Repository:** [https://github.com/Maxkaizo/sql_practice](https://github.com/Maxkaizo/sql_practice)

```